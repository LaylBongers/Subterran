configuration: Release

assembly_info:
  patch: true
  file: AssemblyInfo.*
  assembly_version: "1.0.{build}"
  assembly_file_version: "{version}"
  assembly_informational_version: "{version}"

nuget:
  account_feed: true
  project_feed: true

# Restore NuGet packages before running MSBuild
before_build:
  - nuget restore

build:
  verbosity: minimal

# Remove unneeded files from output directories
after_test:
  - ps: Get-ChildItem "Subterran.Toolbox\bin\$($env:configuration)" -include *.pdb,*.xml -recurse -force | Remove-Item -force
  - ps: Get-ChildItem "Examples\TropicalIsland\bin\$($env:configuration)" -include *.pdb,*.xml -recurse -force | Remove-Item -force
  - ps: Get-ChildItem "Examples\ComponentGallery\bin\$($env:configuration)" -include *.pdb,*.xml -recurse -force | Remove-Item -force

artifacts:
  # Subterran.Toolbox contains all the Subterran libraries in the output
  - path: Subterran.Toolbox\bin\$(configuration)
    name: Subterran Libraries
    type: zip

  - path: Examples\TropicalIsland\bin\$(configuration)
    name: Tropical Island Example
    type: zip

  - path: Examples\ComponentGallery\bin\$(configuration)
    name: Component Gallery Example
    type: zip